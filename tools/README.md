# 教員用ツール

タイピングゲームのスコア確認用ツールです。
児童から報告された6桁のコードから実際のスコアを確認できます。

---

## ツール一覧

| ファイル | 説明 |
|----------|------|
| `スコア確認.html` | ブラウザで動作するデコーダー（推奨） |

---

## スコア確認.html の使い方

1. `スコア確認.html` をダブルクリックしてブラウザで開きます
2. 児童から報告された6桁のコードを入力します
3. コードが正しければ緑色でスコアが表示されます
4. コードが間違っている場合は赤色でエラーが表示されます

### 表示の意味

| 表示 | 意味 |
|------|------|
| 緑色 + スコア | コードが正しく、表示されているスコアが正確です |
| 赤色 + エラー | コードの入力ミス、または不正なコードです |

---

## Excelでスコアを確認する方法

Excelでもスコア確認が可能です。以下の手順でシートを作成してください。

### シートの作成手順

1. 新しいExcelファイルを作成します
2. 以下のようにセルを設定します

| セル | 内容 | 説明 |
|------|------|------|
| A1 | `コード` | ラベル（見出し） |
| B1 | （空欄） | ここに6桁コードを入力 |
| A3 | `スコア` | ラベル |
| B3 | 数式（下記参照） | デコード結果 |
| A4 | `検証` | ラベル |
| B4 | 数式（下記参照） | 正しいかどうか |

### 数式

**B3セル（スコア計算）:**

```
=MOD(MID(B1,1,1)-1+10,10)*1000+MOD(MID(B1,2,1)-5+10,10)*100+MOD(MID(B1,3,1)-3+10,10)*10+MOD(MID(B1,4,1)-9+10,10)
```

**B4セル（検証）:**

```
=IF(AND(
  MID(B1,5,1)*1=MOD(MOD(MID(B1,1,1)-1+10,10)+MOD(MID(B1,2,1)-5+10,10)+MOD(MID(B1,3,1)-3+10,10)+MOD(MID(B1,4,1)-9+10,10),10),
  MID(B1,6,1)*1=MOD(MOD(MID(B1,1,1)-1+10,10)*3+MOD(MID(B1,2,1)-5+10,10)*7+MOD(MID(B1,3,1)-3+10,10)*2+MOD(MID(B1,4,1)-9+10,10)*5,10)
),"OK","エラー")
```

### 使い方

1. B1セルに6桁のコードを入力
2. B3セルにスコアが表示されます
3. B4セルに「OK」と表示されればコードは正しいです
4. 「エラー」と表示された場合は入力ミスか不正なコードです

### 複数のコードを確認する場合

上記の数式を下の行にコピーすれば、複数のコードを一度に確認できます。
例：B1, B2, B3... に複数のコードを入力し、それぞれの行に数式をコピー

---

## コードの仕組み（参考）

スコア申告コードは以下の仕組みで生成されています：

1. **スコアを4桁にする**: 例）156点 → `0156`
2. **各桁にオフセットを加算**: `[1, 5, 3, 9]` を各桁に足して10で割った余り
3. **チェックサム1**: 4桁の単純合計 mod 10
4. **チェックサム2**: 重み付き合計 `(d0×3 + d1×7 + d2×3 + d3×5) mod 10`
5. **6桁コード**: エンコードした4桁 + チェックサム2桁

この仕組みにより：
- 入力ミスを検出できます（2つのチェックサムで二重確認）
- スコアの改ざんを防止できます

---

## 注意事項

- これらのツールは教員用です。児童には配布しないでください
- コードが「エラー」になる場合は、児童にもう一度確認してください
- スコアは0〜9999点の範囲で記録されます
